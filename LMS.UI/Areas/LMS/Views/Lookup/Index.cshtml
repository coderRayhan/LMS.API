@using LMS.UI.Pages.Shared.Components.FormModal;
@using LMS.Domain.Entities;
@inject IConfiguration config
@{
    var h = config.GetValue<string>("APIURL");
}
@model Lookup
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">

<div class="text-right">
    <a onclick="jQueryModalGet('/LMS/Lookup/CreateOrEdit', 'Lookup')" class="btn btn-primary mt-4">Create</a>
</div>
<div id="viewAll" class="ml-4"></div>

<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>
    $(document).ready(() => {
        loadData();
    });

    function jQueryModalGet(url, title) {
        $.ajax({
            method: 'GET',
            url: url,
            success: (data) => {
                if (data.isValid) {
                    $('#form-modal .modal-body').html(data.html);
                    $('#form-modal .modal-title').html(title);
                    $('#form-modal').modal('show');
                }
                console.log(data);
            }
        })
    }

    function loadData() {
        $('#viewAll').load('/LMS/Lookup/LoadAll');
    }

    function deleteData(url) {
        swal({
            title: "Are you sure?",
            text: "Once deleted, you will not be able to recover this imaginary file!",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {
                    $.ajax({
                        method: 'POST',
                        url: url,
                        success: res => {
                            if(res.isValid){
                                swal("Deleted", {
                                    icon: "success",
                                });
                                $('#viewAll').html(res.html);
                            }
                        }
                    })
                    
                } else {
                    swal("Your imaginary file is safe!");
                }
        });
    }
</script>