@using LMS.UI.Pages.Shared.Components.FormModal;
@using LMS.Domain.Entities;
@inject IConfiguration config
@{
    var h = config.GetValue<string>("APIURL");
}
@model List<Lookup>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">

<div class="text-right">
    <a onclick="jQueryModalGet('/LMS/Lookup/Create', 'Lookup')" class="btn btn-primary">Create</a>
    @*<button type="button" class="btn btn-primary mt-4 pull-right" data-bs-toggle="modal" data-bs-target="#exampleModalCenter">Create</button>*@
</div>
<div class="card mt-5">
    <div class="card-body">
        <table class="table table-bordered table-striped mt-2" id="lookupTable" style="width:100%">
            <thead class="thead-primary">
                <tr>
                    <th>Code</th>
                    <th>Name</th>
                    <th>Name (Bangla)</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@item.Code</td>
                        <td>@item.Name</td>
                        <td>@item.NameBN</td>
                        <td>@item.Status</td>
                        <td>
                            <a href="/lms/lookup/edit?id=@item.Id">Edit</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
@(await Component.InvokeAsync<FormModalViewComponent>())

<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script>
    $(document).ready(() => {
        loadData();
        let dt = new DataTable('#lookupTable');
    });

    function jQueryModalGet(url, title){
        $.ajax({
            method: 'GET',
            url: url,
            success: (data) => {
                if(data.isValid){
                    $('#form-modal .modal-body').html(data.html);
                    $('#form-modal .modal-title').html(title);
                    $('#form-modal').modal('show');
                }
                console.log(data);
            }
        })
    }

    function loadData() {
        $.ajax({
            method: 'GET',
            url: '@h' + 'lookup',
            success: (data) => {
                console.log(data);
                $.each(data, (index, val) => {
                    var li = document.createElement("li");
                    var textNode = document.createTextNode(val.name);
                    li.appendChild(textNode);
                    $('#listUl').append(li);
                    console.log(val.name);
                })

            }
        })
    }
</script>